<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script type="text/javascript" src="form.js"></script>
    <link rel="stylesheet" href="styles.css">
    <title>Стакан цен</title>
</head>
<body>

    <div id="price-list"></div> <!-- Здесь будет выводиться информация -->

    <script type="text/javascript">
        const tg = window.Telegram.WebApp;
        tg.expand();

        // Функция для загрузки данных с вашего API (серверного)
        async function loadData() {
            try {
                const response = await fetch('https://functions.yandexcloud.net/d4e0t5v6vkuic14fi3u6', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: 'get_price_data',
                    }),
                });

                const data = await response.json();

                if (data.status === 'success' && data.prices) {
                    displayPrices(data.prices);
                } else {
                    console.error('Ошибка при получении данных');
                }
            } catch (error) {
                console.error('Ошибка:', error);
            }
        }

        // Функция для отображения данных
        function displayPrices(prices) {
            const priceListElement = document.getElementById('price-list');
            priceListElement.innerHTML = ''; // Очистить предыдущие данные

            // Проходим по каждому элементу данных
            prices.forEach(item => {
                if (item.sell_true) {  // Проверяем, что 'sell_true' равно True
                    const priceItem = document.createElement('div');
                    priceItem.innerHTML = `Цена: <strong>${item.price}</strong> (Количество: <strong>${item.lots}</strong>)`;
                    priceListElement.appendChild(priceItem);
                }
            });
        }

        // Загружаем данные с сервера
        loadData();
    </script>

</body>
</html>
